-- üîß CONFIGURATION
local maxPlayers = 5  -- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå
local hopInterval = 3 * 60 * 60  -- ‡∏ó‡∏∏‡∏Å‡πÜ 3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ hop ‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà
local walkInterval = {min = 60, max = 180} -- ‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏∏‡∏Å 1-3 ‡∏ô‡∏≤‡∏ó‡∏µ
local stopInterval = 20  -- ‡∏´‡∏¢‡∏∏‡∏î‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ 20 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
local Http = game:GetService("HttpService")
local TPS = game:GetService("TeleportService")
local Players = game:GetService("Players")
local PathfindingService = game:GetService("PathfindingService")
local Player = Players.LocalPlayer
local API = "https://games.roblox.com/v1/games/"
local _placeId = game.PlaceId
local _jobId = game.JobId
local visitedServers = {}
local lastPositions = {}

-- ‡∏û‡∏ß‡∏á‡∏°‡∏≤‡∏•‡∏±‡∏¢ UI - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ß‡∏á‡∏°‡∏≤‡∏•‡∏±‡∏¢‡πÉ‡∏ô UI
local screenGui = Instance.new("ScreenGui", Player.PlayerGui)
screenGui.Name = "AutoHopUI"
screenGui.ResetOnSpawn = false

local statusLabel = Instance.new("TextLabel")
statusLabel.Parent = screenGui
statusLabel.Text = "System is Ready!"
statusLabel.Size = UDim2.new(0, 150, 0, 40)  -- ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á
statusLabel.Position = UDim2.new(1, -160, 1, -50)  -- ‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏•‡πà‡∏≤‡∏á
statusLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.TextSize = 14  -- ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á
statusLabel.TextAlign = Enum.TextXAlignment.Center
statusLabel.AnchorPoint = Vector2.new(1, 1)  -- ‡∏¢‡∏∂‡∏î‡∏à‡∏∏‡∏î‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏•‡πà‡∏≤‡∏á

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏û‡∏ß‡∏á‡∏°‡∏≤‡∏•‡∏±‡∏¢
local function rotateHandlebars(direction)
    local angle = direction * 15  -- ‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏û‡∏ß‡∏á‡∏°‡∏≤‡∏•‡∏±‡∏¢
    wheelLabel.Rotation = angle
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏û‡∏ß‡∏á‡∏°‡∏≤‡∏•‡∏±‡∏¢
local function updateHandlebarRotation()
    local char = Player.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    local humanoid = char:FindFirstChildOfClass("Humanoid")
    if not hrp or not humanoid then return end

    -- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£
    local direction = hrp.CFrame.lookVector
    local angle = math.atan2(direction.X, direction.Z) * (180 / math.pi)  -- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏à‡∏≤‡∏Å‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà
    rotateHandlebars(angle)  -- ‡∏´‡∏°‡∏∏‡∏ô‡∏û‡∏ß‡∏á‡∏°‡∏≤‡∏•‡∏±‡∏¢‡∏ï‡∏≤‡∏°‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡πà‡∏° (‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏∏‡πà‡∏°)
local function randomBikeMovement()
    local char = Player.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    local humanoid = char:FindFirstChildOfClass("Humanoid")
    if not hrp or not humanoid then return end

    local offset = Vector3.new(math.random(-10, 10), 0, math.random(-10, 10))
    local target = hrp.Position + offset

    -- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏∏‡πà‡∏°
    local path = PathfindingService:CreatePath()
    path:ComputeAsync(hrp.Position, target)
    if path.Status == Enum.PathStatus.Complete then
        -- ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏û‡∏•‡∏¥‡πâ‡∏ß‡πÜ (‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß)
        humanoid:MoveTo(target)
    end
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£ hop ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà
local function ListServers(cursor)
    local url = API .. _placeId .. "/servers/Public?sortOrder=Asc&limit=100" .. (cursor and "&cursor=" .. cursor or "")
    local success, response = pcall(function()
        return Http:JSONDecode(game:HttpGet(url))
    end)
    return success and response or nil
end

local function GetServerWithLowPlayers()
    local cursor = nil
    for _ = 1, 5 do
        local data = ListServers(cursor)
        if not data then return nil end
        for _, server in pairs(data.data) do
            if server.playing <= maxPlayers and server.id ~= _jobId and not visitedServers[server.id] then
                visitedServers[server.id] = true
                return server.id
            end
        end
        cursor = data.nextPageCursor
        if not cursor then break end
    end
    return nil
end

local function SafeTeleport(serverId)
    for attempt = 1, 3 do
        local success, err = pcall(function()
            local hrp = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
            if hrp then hrp.Anchored = true end
            TPS:TeleportToPlaceInstance(_placeId, serverId, Player)
        end)
        if success then return true end
        warn("‚ùå Teleport failed: " .. tostring(err))
        if tostring(err):find("600") then
            warn("üö´ Error 600 detected ‚Äî waiting cooldown")
            wait(30 * 60)  -- ‡∏£‡∏≠ 30 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠ Error 600
        else
            wait(30)
        end
    end
    return false
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏∏‡∏Å‡πÜ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
local function randomLook()
    local cam = workspace.CurrentCamera
    cam.CFrame = cam.CFrame * CFrame.Angles(0, math.rad(math.random(-60, 60)), 0)
end

-- Main Loop
spawn(function()
    local nextStopTime = tick() + stopInterval  -- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏∏‡∏î‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô

    while true do
        -- ‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏∏‡∏î‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ 20 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        if tick() >= nextStopTime then
            -- ‡∏´‡∏¢‡∏∏‡∏î‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏ô‡∏¥‡πà‡∏á
            local humanoid = Player.Character and Player.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = 0  -- ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà
            end
            statusLabel.Text = "Waiting for 20 seconds..."
            wait(20)  -- ‡∏£‡∏≠ 20 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            nextStopTime = tick() + stopInterval  -- ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà
            if humanoid then
                humanoid.WalkSpeed = 16  -- ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥
            end
            statusLabel.Text = "System is Running"
        end

        -- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
        statusLabel.Text = "Hopping Server..."
        local serverId = GetServerWithLowPlayers()
        if serverId then
            SafeTeleport(serverId)  -- ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ teleport ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà
        else
            print("No suitable servers found!")
        end

        -- ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏û‡∏ß‡∏á‡∏°‡∏≤‡∏•‡∏±‡∏¢‡∏ï‡∏≤‡∏°‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà
        updateHandlebarRotation()

        -- ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡πà‡∏°
        randomBikeMovement()

        -- ‡∏´‡∏°‡∏∏‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡πÜ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        randomLook()

        -- ‡∏£‡∏≠‡πÄ‡∏ß‡∏•‡∏≤
        wait(1)
    end
end)
